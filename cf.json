{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Azam test event stack",
    "Resources": {
        "lfnExecutionRole": {
            "Type": "AWS::IAM::Role",
            "Properties": {
              "RoleName": "lfnExecutionRole",
              "AssumeRolePolicyDocument": {
                "Version": "2012-10-17",
                "Statement": [{
                  "Effect": "Allow",
                  "Principal": {
                    "Service": [ "lambda.amazonaws.com" ]
                  },
                  "Action": [ "sts:AssumeRole" ]
                }]
              },
              "Path": "/",
              "Policies": [{
                "PolicyName": "AWSLambdaBasicExecutionRole",
                "PolicyDocument": {
                  "Version": "2012-10-17",
                  "Statement": [{
                    "Effect": "Allow",
                    "Action": [
                      "logs:CreateLogGroup",
                      "logs:CreateLogStream",
                      "logs:PutLogEvents"
                    ],
                    "Resource": "*"
                  }]
                }
              },
              {
                "PolicyName": "AmazonS3FullAccess",
                "PolicyDocument": {
                  "Version": "2012-10-17",
                  "Statement": [{
                    "Effect": "Allow",
                    "Action": "s3:*",
                    "Resource": [
                      "arn:aws:s3:::exchange-data-raw",
                      "arn:aws:s3:::exchange-data-raw/*"
                    ]
                  }]
                }
              }]
            }
          },
      "lfnHandler": {
        "Type": "AWS::Lambda::Function",
        "Properties": {
          "Code": {
            "S3Bucket": "mu-s3-bucket",
            "S3Key": "event-producer-lambda"
          },
          "Description": {
            "Fn::Sub": "Event Producer lambda function"
          },
          "FunctionName": "event-producer-lambda",
          "Handler": "event-producer-lambda",
          "Role": {
            "Fn::GetAtt": [
              "lfnExecutionRole",
              "Arn"
            ]
          },
          "Runtime": "go1.x",
          "Timeout": 300
        }
      }
    }
  }
  
